<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pok√©dex Completa</title>
  <style>
    /* Estilos gerais */
    body {
      background: #222;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0; padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 3rem;
      margin: 0;
    }

    /* Container dos pok√©mons em grid */
    #pokemon-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 16px;
    }

    /* Card individual */
    .pokemon-card {
      background: #333;
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      text-align: center;
      transition: background 0.3s;
      box-shadow: 0 0 8px rgba(255,255,255,0.1);
    }
    .pokemon-card:hover {
      background: #555;
    }

    .pokemon-card img {
      width: 96px;
      height: 96px;
    }

    .pokemon-name {
      margin: 8px 0 4px;
      font-weight: bold;
      font-size: 1.1rem;
      text-transform: capitalize;
    }

    .pokemon-type {
      font-size: 0.9rem;
      color: #eee;
    }

    /* Busca e filtros */
    .search-box, .advanced-search {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    input[type="text"], select {
      padding: 8px;
      border-radius: 6px;
      border: none;
      font-size: 1rem;
      min-width: 200px;
    }

    button {
      padding: 8px 14px;
      background: #666;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.3s;
    }

    button:hover {
      background: #888;
    }

    /* Pagina√ß√£o */
    .pagination {
      text-align: center;
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    /* Modal para detalhes */
    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .modal.show {
      display: flex;
    }

    .modal-content {
      background: #444;
      border-radius: 10px;
      padding: 20px;
      width: 90%;
      max-width: 500px;
      color: white;
      position: relative;
      max-height: 90vh;
      overflow-y: auto;
      text-align: center;
    }

    .modal-close {
      position: absolute;
      top: 10px; right: 15px;
      font-size: 2rem;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
    }

    .modal-content img {
      width: 150px;
      height: 150px;
    }

    .evolution-chain {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .evolution-chain div {
      text-align: center;
      font-size: 0.9rem;
      text-transform: capitalize;
    }
    .evolution-chain img {
      width: 72px;
      height: 72px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(255,255,255,0.2);
    }

    /* Scroll bar modal */
    .modal-content::-webkit-scrollbar {
      width: 8px;
    }
    .modal-content::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }
  </style>
</head>
<body>

<header>
  <h1>Pok√©dex Completa</h1>
</header>

<!-- Caixa de busca simples -->
<div class="search-box">
  <input type="text" id="search" placeholder="Buscar por nome ou n√∫mero" />
  <button onclick="buscarPokemon()">üîç Buscar</button>
</div>

<!-- Filtros avan√ßados -->
<div class="advanced-search">
  <label for="type-filter">Tipo:</label>
  <select id="type-filter"><option value="">Todos</option></select>

  <label for="ability-filter">Habilidade:</label>
  <select id="ability-filter"><option value="">Todas</option></select>

  <button onclick="aplicarFiltros()">Aplicar Filtros</button>
</div>

<!-- Container onde os pok√©mons ser√£o exibidos -->
<section id="pokemon-container"></section>

<!-- Pagina√ß√£o -->
<div class="pagination">
  <button onclick="anteriorPagina()">‚¨Ö Anterior</button>
  <span id="pagina-atual">P√°gina 1</span>
  <button onclick="proximaPagina()">Pr√≥xima ‚û°</button>
</div>

<!-- Modal para detalhes -->
<div id="modal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="fecharModal()">√ó</button>
    <div id="modal-body"></div>
  </div>
</div>

<script>
  // Refer√™ncias aos elementos HTML
  const pokemonContainer = document.getElementById('pokemon-container');
  const modal = document.getElementById('modal');
  const modalBody = document.getElementById('modal-body');
  const searchInput = document.getElementById('search');
  const typeFilter = document.getElementById('type-filter');
  const abilityFilter = document.getElementById('ability-filter');
  const paginaAtualSpan = document.getElementById('pagina-atual');

  // Quantidade de pok√©mons por p√°gina
  const porPagina = 24;

  // Vari√°veis globais que armazenam os pok√©mons e filtrados
  let todosPokemons = [];
  let pokemonsFiltrados = [];
  let paginaAtual = 1;

  // Tradu√ß√£o dos tipos para portugu√™s
  const typeTranslations = {
    fire: 'Fogo',
    water: '√Ågua',
    grass: 'Grama',
    electric: 'El√©trico',
    bug: 'Inseto',
    normal: 'Normal',
    poison: 'Veneno',
    ground: 'Terra',
    fairy: 'Fada',
    fighting: 'Lutador',
    psychic: 'Ps√≠quico',
    rock: 'Pedra',
    ghost: 'Fantasma',
    ice: 'Gelo',
    dragon: 'Drag√£o',
    dark: 'Noturno',
    steel: 'A√ßo',
    flying: 'Voador'
  };

  // Tradu√ß√£o das habilidades para portugu√™s
  const abilityTranslations = {
    overgrow: 'Espessura',
    chlorophyll: 'Clorofila',
    blaze: 'Chama',
    torrent: 'Torrente',
    'shield-dust': 'P√≥ Protetor',
    'run-away': 'Fuga',
    'keen-eye': 'Olho Vivo',
    intimidate: 'Intimida√ß√£o',
    static: 'Est√°tico',
    'lightning-rod': 'Para-raios',
    'sand-stream': 'Tempestade de Areia',
    swarm: 'Enxame',
    'cute-charm': 'Charme',
    whirlwind: 'Redemoinho',
    'flash-fire': 'Chama Induzida',
    competitive: 'Competitivo',
    pressure: 'Press√£o',
    'thick-fat': 'Gordura',
    'early-bird': 'Madrugador',
    'flame-body': 'Corpo de Chamas',
    pickup: 'Catador',
    'dry-skin': 'Pele Seca',
    'wonder-guard': 'Barreira M√°gica',
    levitate: 'Levitador',
    drizzle: 'Garoa',
    'sand-veil': 'V√©u de Areia',
    'snow-cloak': 'Manto de Neve',
    analytic: 'Anal√≠tico',
    download: 'Download',
    sturdy: 'Firme',
    'natural-cure': 'Cura Natural',
    'magic-guard': 'Guarda M√°gica',
    'sap-sipper': 'Absorve Seiva',
    'water-absorb': 'Absor√ß√£o',
    'motor-drive': 'Motor',
    'water-veil': 'V√©u de √Ågua',
    'toxic-boost': 'Impulso T√≥xico',
    moxie: 'Valentia',
    anticipate: 'Antecipa√ß√£o',
    unnerve: 'Nervosismo',
    'pure-power': 'Poder Puro',
    rivalry: 'Rivalidade',
    'magic-bounce': 'Reflexo M√°gico',
    'solid-rock': 'Rocha S√≥lida',
    filter: 'Filtro',
    soundproof: '√Ä Prova de Som',
    'snow-warning': 'Alerta de Neve',
    'solar-power': 'Poder Solar',
    'leaf-guard': 'Guarda Folha',
    'quick-feet': 'P√©s R√°pidos',
    multiscale: 'Multiescala',
    unaware: 'Ignorante',
    plus: 'Mais',
    minus: 'Menos',
    forecast: 'Previs√£o',
    'slow-start': 'In√≠cio Lento',
    'heavy-metal': 'Metal Pesado',
    'light-metal': 'Metal Leve',
    'swift-swim': 'Nado R√°pido',
    damp: '√ömido',
    'sand-rush': 'Corrida na Areia',
    harvest: 'Colheita',
    frantic: 'Desespero',
    unburden: 'Descarrego',
    'weak-armor': 'Armadura Fraca',
    'wonder-skin': 'Pele Maravilha',
    prankster: 'Brincalh√£o',
    'rain-dish': 'Chuva Purificadora',
    'sand-force': 'For√ßa da Areia',
    galvanize: 'Eletrifica√ß√£o',
    'aura-break': 'Quebra Aura',
    'flower-veil': 'V√©u Floral',
    'grand-armour': 'Grande Armadura',
    'primordia-sea': 'Mar Primordial',
  };

  // Fun√ß√£o que carrega os pok√©mons da API (limite 1010)
  async function carregarPokemons() {
    // Pega lista com nomes e URLs dos pok√©mons
    const res = await fetch("https://pokeapi.co/api/v2/pokemon?limit=1010");
    const data = await res.json();

    // Para cada pok√©mon, carrega seus dados detalhados (promises paralelas)
    const promises = data.results.map(p => fetch(p.url).then(r => r.json()));
    todosPokemons = await Promise.all(promises);

    // Inicialmente todos s√£o mostrados
    pokemonsFiltrados = [...todosPokemons];

    // Atualiza os filtros com os tipos e habilidades dispon√≠veis
    atualizarFiltros();

    // Mostra a primeira p√°gina
    mostrarPagina(1);
  }

  // Exibe a p√°gina indicada com os pok√©mons filtrados
  function mostrarPagina(pagina) {
    paginaAtual = pagina;

    // Calcula o intervalo da p√°gina
    const inicio = (pagina - 1) * porPagina;
    const fim = inicio + porPagina;

    // Seleciona apenas os pok√©mons dessa p√°gina
    const paginados = pokemonsFiltrados.slice(inicio, fim);

    // Renderiza os cards na tela
    renderPokemon(paginados);

    // Atualiza o texto da p√°gina
    paginaAtualSpan.textContent = `P√°gina ${paginaAtual} de ${Math.ceil(pokemonsFiltrados.length / porPagina)}`;
  }

  // Renderiza os cards dos pok√©mons passados
  function renderPokemon(pokemons) {
    pokemonContainer.innerHTML = ''; // limpa tudo

    if (pokemons.length === 0) {
      pokemonContainer.innerHTML = '<p>Nenhum Pok√©mon encontrado.</p>';
      return;
    }

    // Para cada Pok√©mon, cria um card
    pokemons.forEach(pokemon => {
      const card = document.createElement('div');
      card.className = 'pokemon-card';

      // Nome capitalizado
      const nome = pokemon.name.charAt(0).toUpperCase() + pokemon.name.slice(1);

      // Traduz tipos para portugu√™s
      const tipos = pokemon.types.map(t => typeTranslations[t.type.name] || t.type.name).join(', ');

      card.innerHTML = `
        <img src="${pokemon.sprites.front_default}" alt="${nome}" />
        <div class="pokemon-name">${nome}</div>
        <div class="pokemon-type">${tipos}</div>
      `;

      // Ao clicar no card abre modal com detalhes
      card.addEventListener('click', () => abrirModal(pokemon));

      pokemonContainer.appendChild(card);
    });
  }

  // Fun√ß√£o para buscar Pok√©mon por nome ou n√∫mero
  async function buscarPokemon() {
    const termo = searchInput.value.toLowerCase().trim();

    if (!termo) {
      alert("Digite um nome ou n√∫mero para buscar!");
      return;
    }

    try {
      const res = await fetch(`https://pokeapi.co/api/v2/pokemon/${termo}`);
      if (!res.ok) throw new Error('Pok√©mon n√£o encontrado');

      const pokemon = await res.json();

      // Mostra somente o Pok√©mon encontrado
      pokemonsFiltrados = [pokemon];
      mostrarPagina(1);
    } catch (error) {
      alert("Pok√©mon n√£o encontrado. Verifique o nome ou n√∫mero.");
    }
  }

  // Fun√ß√£o para atualizar os filtros de tipo e habilidade
  async function atualizarFiltros() {
    // Pega tipos da API e preenche o select
    const tiposRes = await fetch("https://pokeapi.co/api/v2/type");
    const tiposData = await tiposRes.json();

    // Limpa op√ß√µes (exceto a "Todos")
    typeFilter.innerHTML = '<option value="">Todos</option>';
    tiposData.results.forEach(tipo => {
      // Ignorar tipos especiais da API que n√£o s√£o "de pok√©mon"
      if(['shadow', 'unknown'].includes(tipo.name)) return;

      // Traduz e cria option
      const nomeTipo = typeTranslations[tipo.name] || tipo.name;
      typeFilter.innerHTML += `<option value="${tipo.name}">${nomeTipo}</option>`;
    });

    // Pega habilidades da API e preenche o select
    const habRes = await fetch("https://pokeapi.co/api/v2/ability?limit=1000");
    const habData = await habRes.json();

    abilityFilter.innerHTML = '<option value="">Todas</option>';
    habData.results.forEach(hab => {
      // Traduz se poss√≠vel
      const nomeHab = abilityTranslations[hab.name] || hab.name;
      abilityFilter.innerHTML += `<option value="${hab.name}">${nomeHab}</option>`;
    });
  }

  // Aplica os filtros selecionados
  function aplicarFiltros() {
    const tipoSelecionado = typeFilter.value;
    const habilidadeSelecionada = abilityFilter.value;

    pokemonsFiltrados = todosPokemons.filter(pokemon => {
      // Verifica tipo
      const temTipo = tipoSelecionado ? pokemon.types.some(t => t.type.name === tipoSelecionado) : true;

      // Verifica habilidade
      const temHabilidade = habilidadeSelecionada ? pokemon.abilities.some(a => a.ability.name === habilidadeSelecionada) : true;

      return temTipo && temHabilidade;
    });

    mostrarPagina(1);
  }

  // Fun√ß√µes para navega√ß√£o da pagina√ß√£o
  function proximaPagina() {
    const totalPaginas = Math.ceil(pokemonsFiltrados.length / porPagina);
    if (paginaAtual < totalPaginas) {
      mostrarPagina(paginaAtual + 1);
    }
  }

  function anteriorPagina() {
    if (paginaAtual > 1) {
      mostrarPagina(paginaAtual - 1);
    }
  }

  // Fun√ß√£o para abrir modal com detalhes do Pok√©mon
  async function abrirModal(pokemon) {
    // Nome capitalizado
    const nome = pokemon.name.charAt(0).toUpperCase() + pokemon.name.slice(1);

    // Tradu√ß√£o dos tipos
    const tipos = pokemon.types.map(t => typeTranslations[t.type.name] || t.type.name).join(', ');

    // Tradu√ß√£o das habilidades
    const habilidades = pokemon.abilities.map(a => abilityTranslations[a.ability.name] || a.ability.name).join(', ');

    // Status formatado
    const status = pokemon.stats.map(s => `<li><strong>${s.stat.name.toUpperCase()}:</strong> ${s.base_stat}</li>`).join('');

    // Imagem maior do Pok√©mon
    const imagem = pokemon.sprites.other['official-artwork'].front_default || pokemon.sprites.front_default;

    // Busca cadeia de evolu√ß√£o
    const evolucaoHTML = await pegarEvolucao(pokemon.species.url);

    // Conte√∫do do modal
    modalBody.innerHTML = `
      <h2>${nome}</h2>
      <img src="${imagem}" alt="${nome}" />
      <p><strong>Tipos:</strong> ${tipos}</p>
      <p><strong>Habilidades:</strong> ${habilidades}</p>
      <h3>Status</h3>
      <ul style="list-style:none; padding-left:0;">${status}</ul>
      <h3>Evolu√ß√£o</h3>
      <div class="evolution-chain">${evolucaoHTML}</div>
    `;

    modal.classList.add('show');
  }

  // Fun√ß√£o para fechar modal
  function fecharModal() {
    modal.classList.remove('show');
  }

  // Fun√ß√£o que obt√©m a cadeia de evolu√ß√£o de uma esp√©cie
  async function pegarEvolucao(urlSpecies) {
    try {
      // Pega dados da esp√©cie
      const resEsp = await fetch(urlSpecies);
      const dataEsp = await resEsp.json();

      // Pega URL da cadeia de evolu√ß√£o
      const urlEvo = dataEsp.evolution_chain.url;

      // Pega dados da cadeia de evolu√ß√£o
      const resEvo = await fetch(urlEvo);
      const dataEvo = await resEvo.json();

      // Fun√ß√£o recursiva para extrair evolu√ß√£o em ordem
      const evolucoes = [];
      let current = dataEvo.chain;

      do {
        evolucoes.push(current.species.name);
        current = current.evolves_to[0];
      } while (current && current.hasOwnProperty('evolves_to'));

      // Pega dados de cada evolu√ß√£o para mostrar imagem
      const promises = evolucoes.map(nome => fetch(`https://pokeapi.co/api/v2/pokemon/${nome}`).then(r => r.json()));
      const pokemonsEvolucao = await Promise.all(promises);

      // Monta HTML para cadeia de evolu√ß√£o
      return pokemonsEvolucao.map(p => `
        <div>
          <img src="${p.sprites.front_default}" alt="${p.name}" />
          <div>${p.name.charAt(0).toUpperCase() + p.name.slice(1)}</div>
        </div>
      `).join('');
    } catch {
      return '<p>Informa√ß√£o de evolu√ß√£o indispon√≠vel.</p>';
    }
  }

  // Fecha modal ao clicar fora do conte√∫do
  modal.addEventListener('click', e => {
    if (e.target === modal) fecharModal();
  });

  // Inicializa tudo ao carregar a p√°gina
  window.onload = carregarPokemons;

</script>

</body>
</html>
